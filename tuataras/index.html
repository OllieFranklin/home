<!DOCTYPE html>
<html>

<head>
	<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
	<meta content="utf-8" http-equiv="encoding">
	<meta name="viewport" content="initial-scale=1">
	<title>Tuatara luck calculator</title>
</head>

<body>

	<h1>Tuatara Luck Calculator</h1>

	<p>
		<label for="weather">What is the weather like today?</label>
		<select name="weather" id="weather">
			<option value="none" selected="selected"></option>
			<option value="sunny">Hot/Sunny</option>
			<option value="mild">Mild/Windy</option>
			<option value="rainy">Cold/Rainy</option>
		</select>
	</p>
	
	<div id="tuatara1">
		<h3>Tuatara 1</h3>
		<label for="tuatara1">Where is the tuatara?</label>
		<select name="tuatara1" id="tuatara1_dropdown">
			<option value="not_visible" selected="selected">Not visible</option>
			<option value="half_out">Partially inside a tunnel</option>
			<option value="fully_out">Fully visible</option>
			<option value="under_light">Under a lamp</option>
		</select>
	</div>

	<div id="tuatara2">
		<h3>Tuatara 2</h3>
		<label for="tuatara2">Where is the tuatara?</label>
		<select name="tuatara2" id="tuatara2_dropdown">
			<option value="not_visible" selected="selected">Not visible</option>
			<option value="half_out">Partially inside a tunnel</option>
			<option value="fully_out">Fully visible</option>
			<option value="under_light">Under a lamp</option>
		</select>
	</div>

	<div id="tuatara3">
		<h3>Tuatara 3</h3>
		<label for="tuatara3">Where is the tuatara?</label>
		<select name="tuatara3" id="tuatara3_dropdown">
			<option value="not_visible" selected="selected">Not visible</option>
			<option value="half_out">Partially inside a tunnel</option>
			<option value="fully_out">Fully visible</option>
			<option value="under_light">Under a lamp</option>
		</select>
	</div>

	<p>
		<input id="moved" type="checkbox" ><label for="moved">   A tuatara moved!</label><br>
	</p>

	<button id="go" onclick="getLuck">Calculate</button>

	<h2 id="luck"></h2>

	<script type="text/javascript">

		const BONUS = 15;
		
		const Weather = {
			"SUNNY": 20,
			"MILD": 28,
			"RAINY": 33
		};

		const Position = {
			"NOT_OUT": 0,
			"UNDER_LIGHT": 0.3,
			"FULLY_OUT": 0.6,
			"HALF_OUT": 1
		};

		let weather = null;
		let pos = [Position.NOT_OUT, Position.NOT_OUT, Position.NOT_OUT];

		function selectPos(num) {
			console.log("thing");
			const id = "tuatara" + num + "_dropdown";
			const e = document.getElementById(id);

			if (e.value === "not_visible") {
				pos[num - 1] = Position.NOT_OUT;
			} else if (e.value === "half_out") {
				pos[num - 1] = Position.HALF_OUT;
			} else if (e.value === "fully_out") {
				pos[num - 1] = Position.FULLY_OUT;
			} else if (e.value === "under_light") {
				pos[num - 1] = Position.UNDER_LIGHT;
			}

		}

		function getLuck() {

			selectWeather();
			selectPos(1);
			selectPos(2);
			selectPos(3);

			const e = document.getElementById("luck");
			
			if (weather !== null) {
				const luck = Math.round(weather*pos[0] + weather*pos[1] + weather*pos[2]);

				const hasBonus = document.getElementById("moved").checked;
				if (hasBonus) {
					e.innerHTML = (luck + BONUS) + "% luck today (" + BONUS + "% bonus luck)"
				} else {
					e.innerHTML = luck + "% luck today";
				}
			} else {
				e.innerHTML = "Please select all the things";
			}

		}

		function selectWeather() {
			var e = document.getElementById("weather");
		    
		    if (e.value == "sunny") {
		    	weather = Weather.SUNNY;
		    } else if (e.value == "mild") {
		    	weather = Weather.MILD;
		    } else if (e.value == "rainy") {
		    	weather = Weather.RAINY;
		    }
		}


		window.onload = function() {

			document.getElementById("weather").value = "none";
			document.getElementById("tuatara1_dropdown").value = "not_visible";
			document.getElementById("tuatara2_dropdown").value = "not_visible";
			document.getElementById("tuatara3_dropdown").value = "not_visible";

			document.getElementById("moved").checked = false;

			document.getElementById("go").addEventListener("click", getLuck);
		}


	</script>

</body>
</html>